<?xml version="1.0" encoding="UTF-8" ?>
<definitions id="definitions" targetNamespace="http://activiti.org/bpmn20" xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:activiti="http://activiti.org/bpmn">

	<process id="editCheck" name="Edit Check">

		<startEvent id="theStart">
			<extensionElements>
				<activiti:formProperty id="checkId" name="Id de cheque" type="string" required="true" />
			</extensionElements>
		</startEvent>

		<sequenceFlow id="flow0" sourceRef="theStart" targetRef="loadCheck" />

		<serviceTask id="loadCheck" name="Cargar cheque" activiti:class="mz.ex.activiti.check.LoadCheckServiceTask" />

		<sequenceFlow id="flow1" sourceRef="theStart" targetRef="fork" />

		<!-- SE ABREN LAS TAREAS *************************************************************************** -->
		<parallelGateway id="fork" />
		<sequenceFlow sourceRef="fork" targetRef="editRoute" />
		<sequenceFlow sourceRef="fork" targetRef="editAccount" />

		<!-- 	private String bank;
	private String branchOffice;
	private String postalCode;
	private int routeDigit; -->

		<userTask id="editRoute" name="Editar ruta de cobro">
			<extensionElements>
				<activiti:formProperty id="bank" name="Codigo de Banco" type="string" />
				<activiti:formProperty id="branchOffice" name="Codigo de sucursal" type="string" />
				<activiti:formProperty id="postalCode" name="Codigo postal" type="string" />
				<activiti:formProperty id="routeDigit" name="Digito verificador de ruta de cobro" type="long" />
			</extensionElements>

			<potentialOwner>
				<resourceAssignmentExpression>
					<formalExpression>route</formalExpression>
				</resourceAssignmentExpression>
			</potentialOwner>
		</userTask>

		<sequenceFlow sourceRef="editRoute" targetRef="editRouteService" />
		<serviceTask id="editRouteService" name="Modificar ruta de cheque" activiti:class="mz.ex.activiti.check.EditRouteServiceTask" />

		<sequenceFlow sourceRef="editRouteService" targetRef="join" />


		<!-- 	private String account;
	private int accountDigit; -->
		<userTask id="editAccount" name="Editar numero de cuenta">
			<extensionElements>
				<activiti:formProperty id="account" name="Numero de cuenta" type="string" />
				<activiti:formProperty id="accountDigit" name="Digito verificador de Numero de cuenta" type="long" />
			</extensionElements>

			<potentialOwner>
				<resourceAssignmentExpression>
					<formalExpression>account</formalExpression>
				</resourceAssignmentExpression>
			</potentialOwner>
		</userTask>

		<sequenceFlow sourceRef="editAccount" targetRef="editAccountService" />
		<serviceTask id="editAccountService" name="Modificar cuenta de cheque" activiti:class="mz.ex.activiti.check.EditAccountServiceTask" />

		<sequenceFlow sourceRef="editAccountService" targetRef="join" />


		<!-- SE UNEN LAS TAREAS *************************************************************************** -->
		<parallelGateway id="join" />
		<sequenceFlow sourceRef="join" targetRef="archiveCheck" />

		<userTask id="archiveCheck" name="Archivar cheque">
			<documentation>
				Archivando cheque ${checkId}.
			</documentation>

			<potentialOwner>
				<resourceAssignmentExpression>
					<formalExpression>manager</formalExpression>
				</resourceAssignmentExpression>
			</potentialOwner>
		</userTask>
		<sequenceFlow sourceRef="archiveCheck" targetRef="archiveCheckService" />
		<serviceTask id="archiveCheckService" name="Archivar finalmente cheque" activiti:class="mz.ex.activiti.check.ArchiveCheckServiceTask" />

		<sequenceFlow sourceRef="archiveCheckService" targetRef="theEnd" />

		<endEvent id="theEnd" />
	</process>

</definitions>